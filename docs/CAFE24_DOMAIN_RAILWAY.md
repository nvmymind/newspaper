# Cafe24 도메인을 Railway에 연결하기

Cafe24에서 구매/보유한 도메인을 Railway에 배포된 서비스에 연결하는 방법입니다.  
**Railway**와 **Cafe24** 양쪽에서 순서대로 설정하면 됩니다.

---

## 사전 확인

- Railway에서 앱이 **정상 배포**되어 `https://xxxx.up.railway.app` 로 접속 가능한 상태여야 합니다.
- Cafe24 도메인은 **Cafe24 네임서버**를 사용 중이어야 DNS 설정이 가능합니다.  
  (다른 업체 네임서버를 쓰면 해당 업체 관리 화면에서 설정해야 합니다.)
- **www.도메인.com** 형태로 연결하는 것이 가장 쉽고, **도메인.com**(루트)만 쓰려면 Cafe24 제한이 있을 수 있습니다(아래 참고).

---

# 1. Railway 쪽 설정

## 1-1. 서비스 화면으로 이동

1. **https://railway.app** 로그인
2. **newspaper** 프로젝트 클릭
3. **newspaper** 서비스 카드 클릭 (웹 서비스 하나가 보이는 그 카드)
4. 상단 탭에서 **「Settings」** 클릭

## 1-2. 커스텀 도메인 추가

1. Settings 화면에서 **아래로 스크롤**
2. **「Networking」** 또는 **「Public Networking」** 섹션 찾기
3. **「Custom Domain」** 또는 **「+ Custom Domain」** / **「Add Custom Domain」** 입력란 찾기
4. **입력란에 Cafe24 도메인 입력**
   - **www 사용 (권장):** `www.soneson.kr` 처럼 **www.도메인.확장자** 입력  
     → 나중에 Cafe24에서 **www**에 대한 CNAME만 설정하면 됨
   - **루트만 사용:** `soneson.kr` 처럼 **도메인.확장자**만 입력  
     → Cafe24에서 루트 도메인 CNAME 지원 여부에 따라 설정이 다름(아래 Cafe24 섹션 참고)
5. **「+ Custom Domain」** 또는 **「Add」** 버튼 클릭

## 1-3. Railway가 알려주는 CNAME 값 복사

1. 도메인을 추가하면 Railway가 **CNAME 레코드용 값**을 표시합니다.
2. 형식은 대략 **`xxxxxx.up.railway.app`** (영문+숫자 조합).
3. 이 값을 **그대로 복사**해 두세요.  
   - 화면에 **「CNAME」**, **「Value」**, **「Target」** 등으로 표시될 수 있습니다.  
   - **값 전체**(예: `a1b2c3d4e5f6.up.railway.app`)를 복사하면 됩니다.
4. **Target Port**가 나오면, 앱이 사용하는 포트(예: 8080)가 선택되어 있는지 확인. 보통 자동으로 잡힙니다.
5. (선택) **www**와 **루트** 둘 다 쓰려면, Railway 플랜에 따라 커스텀 도메인 2개까지 추가 가능.  
   - 먼저 **www.도메인.com** 추가 → CNAME 값 복사  
   - 그 다음 **도메인.com** 추가 → CNAME 값 복사(같은 값일 수 있음)

## 1-4. SSL·검증

- DNS 설정을 Cafe24에서 마치면, Railway가 자동으로 도메인을 검증하고 **HTTPS 인증서**를 발급합니다.
- 도메인 옆에 **초록색 체크**가 뜨면 연결·SSL 설정이 완료된 것입니다.
- 반영까지 **몇 분~최대 72시간** 걸릴 수 있으니, 10~30분 후에 다시 확인해 보세요.

---

# 2. Cafe24 쪽 설정

## 2-1. DNS 관리 화면 들어가기

1. **https://www.cafe24.com** 로그인
2. **마이캐페24** 또는 **쇼핑몰/서비스 관리** 쪽으로 이동
3. **도메인** 관련 메뉴 찾기  
   - 예: **「도메인」** → **「내 도메인」** / **「도메인 관리」**  
   - 또는 **「호스팅/도메인」** → **「도메인 관리」**
4. 연결할 **도메인 선택** (예: soneson.kr)
5. **「DNS 설정」**, **「DNS 관리」**, **「네임서버 설정」** 같은 메뉴 클릭  
   → **호스트 등록** / **레코드 관리** 화면으로 들어갑니다.

(메뉴 이름이 다르면: **고객센터** 또는 **도메인 도움말**에서 “DNS 설정”, “CNAME”으로 검색해 보세요.)

## 2-2. www 서브도메인용 CNAME 추가 (권장)

**www.도메인.com** 으로 접속하게 하려면:

1. **「CNAME 추가」**, **「별칭(CNAME) 관리」** 등 CNAME 관련 버튼/탭 클릭
2. **새 CNAME 레코드** 추가 시 다음처럼 입력:
   - **호스트 / 이름 / 별칭:**  
     - `www` 만 입력하는 경우가 많습니다.  
     - “호스트”가 “전체 도메인”이면 비우고 “www”만 넣는 경우도 있습니다.  
     - 화면에 **「www 입력 시 www.도메인.com 으로 연결」** 같은 설명이 있으면 그대로 **www** 입력.
   - **값 / 대상 / 실제 도메인명 / 목표:**  
     → **Railway에서 복사한 CNAME 값** 그대로 붙여넣기  
     (예: `a1b2c3d4e5f6.up.railway.app`)  
     - 끝에 **마침표(.)** 를 넣으라고 하면 넣고, 안 내면 빼도 됩니다.
3. **저장** / **확인** / **등록** 클릭

## 2-3. 루트 도메인(도메인.com만) 사용할 때

- **Cafe24**는 루트 도메인(**@** 또는 “도메인만”)에 **CNAME**을 직접 지원하지 않는 경우가 많습니다.
- 이 경우 선택지는 두 가지입니다.
  1. **www만 사용**  
     - Railway에는 **www.도메인.com** 만 추가하고,  
     - 사용자에게 **https://www.soneson.kr** 로 접속하도록 안내.
  2. **루트(도메인.com) 연결이 꼭 필요할 때**  
     - Cafe24 고객센터/도움말에 **“루트 도메인 CNAME”** 또는 **“ALIAS/ANAME”** 지원 여부 문의.  
     - 또는 **Cloudflare** 같은 DNS를 사용하면 루트에 CNAME(Flattening) 설정이 가능합니다.  
       (도메인 네임서버를 Cafe24 → Cloudflare로 변경해야 함.)

## 2-4. 저장 후 대기

- **저장** 후 DNS 전파에 **수 분~24시간** 걸릴 수 있습니다.
- 빠르게 확인하려면:  
  - Railway **Settings → Networking** 에서 도메인 옆 **초록 체크**  
  - 브라우저 시크릿 창에서 **https://www.도메인.com** 접속

---

# 3. 연결 확인

| 확인 항목 | 방법 |
|-----------|------|
| Railway에서 도메인 인식 | Railway **Settings → Networking** 에서 해당 도메인 옆 **초록색 체크** |
| 실제 접속 | 브라우저에서 **https://www.도메인.com** (또는 **https://도메인.com**) 접속 |
| SSL 동작 | 주소창에 자물쇠 표시가 있고, **https** 로 열리는지 확인 |

---

# 4. 문제 해결

- **Railway에 “도메인 검증 실패” / 계속 대기**
  - Cafe24 DNS에 **CNAME 값이 Railway에서 준 값과 완전히 동일**한지 확인(오타, 공백, http:// 없음).
  - 30분~1시간 후 다시 확인. 최대 72시간까지 걸릴 수 있음.
- **Cafe24에 CNAME 메뉴가 없다**
  - 해당 도메인이 **Cafe24 네임서버**를 쓰는지 확인.
  - **도메인** → **네임서버 설정**에서 “Cafe24 네임서버 사용”으로 되어 있어야 Cafe24 관리 화면에서 DNS 수정 가능.
- **www는 되는데 도메인.com 은 안 된다**
  - Cafe24가 루트 CNAME을 지원하지 않는 경우일 수 있음.  
    당분간 **www.도메인.com** 으로만 사용하거나, Cloudflare/고객센터 문의.

---

# 5. "여전히 연결이 안 될 때" 점검 목록

아래를 **위에서부터 순서대로** 확인하세요.

## 5-1. DNS가 실제로 Railway를 가리키는지 확인

1. **Railway** → Settings → Networking → `www.soneson.kr` 옆 **「Show DNS records」** 클릭  
   → 표시되는 **CNAME 값**(예: `newspaper-production-3d24.up.railway.app`)을 복사해 둡니다.
2. **https://www.whatsmydns.net** 접속  
   → "Search"에 **www.soneson.kr** 입력 → **CNAME** 선택 → **Search** 클릭.
3. 결과에 **방금 복사한 Railway 주소**가 나오나요?
   - **나오면** → DNS는 정상. Railway 쪽 검증 대기이거나, 5-3(도메인 다시 추가) 시도.
   - **안 나오거나 다른 값** → Cafe24 DNS가 잘못됐거나 아직 전파 안 됨. 5-2로.

## 5-2. Cafe24 CNAME 입력값 다시 확인

Cafe24 **도메인 관리 → DNS 설정 → 별칭(CNAME) 관리**에서:

| 항목 | 올바른 예 | 잘못된 예 |
|------|-----------|-----------|
| **도메인 별칭** (호스트) | `www` 만 | `www.soneson.kr`, `https://www` 등 |
| **실제 도메인명** (값/대상) | `newspaper-production-3d24.up.railway.app` | `https://...`, `http://...`, 끝에 `/` 있음, 오타 |

- **http:// / https://** 넣지 말 것.
- **공백, 슬래시(/)**, 맨 뒤 **마침표(.)** 없이 Railway에서 보여준 값 **그대로**만.
- **www** 레코드가 **두 개** 있으면 하나만 남기고, 값이 Railway CNAME인 것만 두세요.
- **www**에 **A 레코드**가 이미 있으면 CNAME과 충돌할 수 있음. A 레코드 삭제 후 CNAME만 두세요.

저장 후 5~10분 지나서 다시 **whatsmydns.net**으로 www.soneson.kr CNAME 조회해 보세요.

## 5-3. Railway에서 도메인 제거 후 다시 추가

1. Railway **Settings** → **Networking** → `www.soneson.kr` 옆 **휴지통(삭제)** 클릭.
2. **1~2분** 기다린 뒤 **+ Custom Domain** 에 `www.soneson.kr` 다시 입력해 추가.
3. 표시되는 **CNAME 값**을 다시 복사해, Cafe24에 입력한 값과 **완전히 같은지** 비교.
4. 10~30분 후 Railway에서 도메인 옆 **초록 체크**가 뜨는지 확인.

## 5-4. 네임서버 확인 (Cafe24가 DNS를 관리하는지)

- 도메인 **등록 업체**(가비아, 호스팅케이알 등)에서 **네임서버**가 **Cafe24**로 설정돼 있어야, Cafe24에서 수정한 DNS가 적용됩니다.
- Cafe24 **도메인 관리** 또는 도메인 등록 업체 화면에서 **네임서버**가 Cafe24 안내한 주소(예: ns1.cafe24.com 등)인지 확인하세요.
- 다른 업체 네임서버를 쓰고 있으면 Cafe24에서 건 CNAME은 적용되지 않습니다.  
  → 네임서버를 Cafe24로 바꾸거나, 실제 DNS를 관리하는 업체 화면에서 CNAME을 넣어야 합니다.

## 5-5. 그래도 안 되면

- **24~48시간** 지나도 Railway에 "Waiting for DNS update"가 계속 뜨면,  
  Cafe24 고객센터에 **"www CNAME을 외부 주소(railway.app)로 연결했는데 반영이 안 된다"**고 문의해 보세요.
- **Cloudflare**를 쓰는 경우: Railway 문서에 따르면 CNAME을 **DNS only(회색 구름)** 로 두어야 할 수 있습니다.

---

**요약**

1. **Railway:** Settings → Networking → Custom Domain에 **www.도메인.com** (또는 도메인.com) 입력 → 표시된 **CNAME 값** 복사.  
2. **Cafe24:** DNS 관리 → CNAME 추가 → 호스트 **www**, 값에 **Railway CNAME** 붙여넣기 → 저장.  
3. 몇 분~몇 시간 후 Railway에서 초록 체크, 브라우저에서 **https://www.도메인.com** 접속 확인.

이 가이드는 Cafe24·Railway 일반적인 화면 기준으로 작성되었습니다. 메뉴 이름이 다르면 Cafe24 도메인 도움말을 참고해 같은 의미의 메뉴를 찾으면 됩니다.
